# [傷害] Damage

Owner: 黃柏鈞
Created time: October 27, 2024 3:27 PM

一個「**傷害**(Damage)」的數值是由「傷害**來源**」和「攻擊標籤」，相關限制及傷害加成計算而來。

## 最終傷害計算

> $\mathrm{基礎傷害}\times(1+\Sigma\mathrm{增加傷害})\times(1+(\mathrm{基礎暴擊傷害加成}+\Sigma\mathrm{暴擊傷害加成}))\times(1-\mathrm{護甲減免率})\times(1-\Sigma\mathrm{傷害減免})\times(1+\Sigma\mathrm{承受傷害})$

- **基礎傷害**：防禦塔或其他攻擊單位的初始攻擊力。
- **基礎暴擊傷害加成**和**Σ暴擊傷害加成**：計算暴擊後的額外傷害（例如基礎暴傷 50%，以及額外暴傷加成）。
- **護甲減免率**：基於護甲公式計算的減免率，反映護甲對傷害的抵銷程度。
- **傷害減免**：其他減免效果，可能來自怪物的技能、狀態等。
- **承受傷害**：對傷害的增加效果，可能來自 debuff 或特殊狀態，會增加敵人受到的傷害。
- **增加傷害**：作為加法加成，用於增加傷害的基礎數值，加成可以調整和累加。

### 護甲減免率計算

> $有效穿甲率=\frac{\Sigma\mathrm{穿甲效果}}{\Sigma\mathrm{穿甲效果}+C}$

常數 **C 為** **100**，用來控制邊際遞減的速率。

- **穿甲效果**：部分忽略敵人的護甲值，以此來減少敵人護甲對傷害的抵消效果。
  - 當 **Σ穿甲效果** 很小時，**有效穿甲率** 接近於 **Σ穿甲效果**。
  - 當 **Σ穿甲效果** 增加到接近 **C** 的時候，邊際效益開始明顯遞減。
  - 最多只能忽略敵人 **75%** 的護甲。
- 穿甲效果是 **50%**：
  $\text{有效穿甲率} = \frac{50}{50 + 100} = \frac{50}{150} \approx 0.333 \, (33.3\%)$
- 穿甲效果累加到 **150%**：
  $\text{有效穿甲率} = \frac{150}{150 + 100} = \frac{150}{250} = 0.6 \, (60\%)$

> $穿甲後護甲=護甲×(1−Σ有效穿甲率)$

> $護甲公式=\frac{\mathrm{穿甲後護甲}}{\mathrm{穿甲後護甲}+\mathrm{常數}K​}$

常數 **K** 為 **500**，護甲值在達到 **500** 左右時，開始產生邊際效益的遞減。

- **低護甲值的情況**（護甲 < 500）：
  - 當護甲值低於 **500** 時，減免率增加相對較快。例如：
    - 護甲值為 **250** 時：
      - $傷害減免率 =\frac{250}{250 + 500} = \frac{250}{750} \approx 0.333 \,$
  - 增加護甲對減免率的提升效果較明顯。
- **高護甲值的情況**（護甲 > 500）：
  - 當護甲值超過 **500**，隨著護甲的增加，減免率的提升速度會逐漸變慢。例如：
    - 護甲值為 **1000** 時：
      - $傷害減免率 =\frac{1000}{1000 + 500} = \frac{1000}{1500} = 0.667$
    - 護甲值為 **2000** 時：
      - $傷害減免率 =\frac{2000}{2000 + 500} = \frac{2000}{2500} = 0.8$
  - 當護甲進一步增加時，傷害減免率的增長開始顯著減少，避免護甲值過高導致幾乎完全免疫傷害。

## 傷害範例 1

- **基礎傷害 = 1000**
- **Σ增加傷害 = 0.3**（增加傷害總和 30%）
- **基礎暴擊傷害加成 = 0.2**（20%）
- **Σ暴擊傷害加成 = 0.3**（30%）
- **護甲 = 600**，**無穿甲效果**，直接使用護甲減免公式
  - $\text{護甲減免率} = \frac{護甲}{護甲 + 500} = \frac{600}{600 + 500} \approx 0.545$
- **Σ傷害減免 = 0.1**（10%）
- **Σ承受傷害 = 0.2**（20%）

1. **套入公式計算最終傷害**：$最終傷害=1000×(1+0.3)×(1+(0.2+0.3))×(1−0.545)×(1−0.1)×(1+0.2)$
2. **逐步計算**：
   - 增加傷害部分：
     $1+0.3=1.3$
   - 暴擊加成部分：
     $1.51 + (0.2 + 0.3) = 1.5$
   - 護甲減免後：
     $1−0.545=0.455$
   - 傷害減免後：
     $1−0.1=0.9$
   - 承受傷害加成：
     $1+0.2=1.2$
3. 結果：$最終傷害=1000×1.3×1.5×0.455×0.9×1.2≈957.42$

## 傷害範例 2

假設：

- **基礎傷害 = 1000**
- **Σ增加傷害 = 0.3**（增加傷害總和 30%）
- **基礎暴擊傷害加成 = 0.2**（20%）
- **Σ暴擊傷害加成 = 0.3**（30%）
- **護甲 = 600**
- **Σ穿甲效果 = 100%**（多件裝備提供累加後的穿甲效果總和）
  - **計算有效穿甲率**：
    $\text{有效穿甲率} = \frac{100}{100 + 100} = 0.5 \, (50\%)$
  - **計算穿甲後護甲**：
    $\text{穿甲後護甲} = 600 \times (1 - 0.5) = 600 \times 0.5 = 300$
  - **計算護甲減免率**：
    $\text{護甲減免率} = \frac{300}{300 + 500} = \frac{300}{800} = 0.375 \, (37.5\%)$
- **Σ傷害減免 = 0.1**（10%）
- **Σ承受傷害 = 0.2**（20%）

1. **套入公式計算最終傷害**

   $\text{最終傷害} = 1000 \times (1 + 0.3) \times (1 + (0.2 + 0.3)) \times (1 - 0.375) \times (1 - 0.1) \times (1 + 0.2)$

2. **逐步計算**：
   - 增加傷害部分：
     $1+0.3=1.3$
   - 暴擊加成部分：
     $1+(0.2+0.3)=1.5$
   - 護甲減免後：
     $1−0.375=0.625$
   - 傷害減免後：
     $1−0.1=0.9$
   - 承受傷害加成：
     $1+0.2=1.2$
3. 結果：$最終傷害 = 1000 \times 1.3 \times 1.5 \times 0.625 \times 0.9 \times 1.2 \approx 1096.88$
